# FengLingCao
一.简介

独立开发的一套APP-树莓派-Arduino联动系统，用于监控室内环境并适当对其做出合理的调节。

二.说明

任何个人或组织均可在标明原作者的情况下使用或修改本项目的代码，虽然代码写得很烂就是了。

三.目前仍然存在的bug或不完善的地方

由于Arduino、树莓派、APP都是独立完成的，bug和不足在所难免。

1.对于Arduino，作者在使用SCoop时发现Arduino无法对String类型的变量进行赋值，因此最终决定使用Chrono。精力有限，只完成了最简单的定时刷新LCD屏幕的功能，其他功能均通过轮询方式实现。

2.对于树莓派，作为这套系统的上位机，它需要完成火焰识别、数据处理分析和APP连接等任务，同样由于精力有限，作者在编写针对下位机的指令时，直接将指令的每一部分以事先编辑好的字符串形式输出（本来预期是通过树莓派分析之后由树莓派决定指令的每一部分是什么）；由于数据集不够大，样本比较单一，火焰识别模型的效果并不是很好，时不时会出现误判的现象，但大体上还是不错的.

3.对于APP，目前开发出的软件仅支持API 28及以上的Android手机（API 28以下的手机作者没有测试过，理论上应该也是可以运行的），作者并不是本专业的学生，因此在软件优化上会有所欠缺，同时，APP不会识别用户当前的网络状态，所以在连接树莓派时，请先自行将手机与树莓派连接在同一局域网内；在切换成自定义IP地址及端口后，请点击右下角灰色按钮，按照Toast弹出的消息操作，如果出现"更改失败"的提示，请退出APP重新操作（这里的错误作者暂时没有解决，毕竟刚学AndroidStudio一个星期）。

四.如何操作

首先请将arduino文件夹下的ino文件烧录进你的Arduino开发板里，然后按照代码中的引脚配置连接好相关传感器或者设备（Chrono库请自行去原作者的Git下载）。

然后将raspbepi文件夹拷贝到你的树莓派上，打开其中的YOLO-RPI-Arduino.py文件，运行它（相关的库请自行百度下载方法）。

最后安装apk文件夹中的apk文件到您的手机上，如果不放心其安全性，可以用AndroidStudio打开AndroidStudioProect文件夹下的CloudLivingRoom项目文件夹,查看源码。作者也想偷走你们的隐私，奈何实力不允许（开个玩笑）。

一切准备就绪之后，树莓派和Arduino开发板已经在运行状态了，摄像头识别到火焰时，会自动给arduino发送相关指令，命令其开窗和报警；当环境温度过高或湿度过低时，树莓派也会通知arduino开窗和开风扇。比较新颖的一点是，作者添加了简单的疫情防控逻辑，当有人接近房门时，树莓派会通知arduino开启疫情防控模块，提醒此人勤洗手，并按需为其提供洗手液。

APP是否接入对个系统影响不大，在使用APP时，请先确认树莓派的IP地址及端口。

a.如果默认设置满足条件的话，请直接点击右下角灰色按钮连接树莓派，出现"连接成功"提示后，点击"开始通信按钮"，之后APP会自动更新树莓派的CPU、内存使用状态和室内的温度、湿度数据，此时可点击窗户开关和风扇开关来控制窗户和风扇的状态。目前这个系统只是一个概念模型，因此场景有限，如果作者以后有时间的话，会对其进行完善的；

b.如果默认设置下的IP地址或端口有误，请自行查询树莓派的IP地址和端口，在YOLO-RPI-Arduino.py中修改之，并在APP中输入修改后的参数，打开"使用自定义配置"开关，然后点击灰色按钮连接树莓派。

c.注意，在YOLO-RPI-Arduino.py中，为了确保每一个线程运行时不会报错，作者在端口绑定的代码中添加了try-except语句，try中的bind配置是默认配置，而except中的bind配置是备用配置，修改时请不要将二者改为一样，用APP连接时，如果提示"服务器无响应"，请考虑使用备用配置连接，方法同b.。
